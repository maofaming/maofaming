(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d71c3ec"],{"070c":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},o=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[i("div",{staticClass:"heading"},[i("h1",{staticClass:"title"},[t._v("2048")]),i("div",{staticClass:"scores-container"},[i("div",{staticClass:"score-container"},[t._v("0")]),i("div",{staticClass:"best-container"},[t._v("0")])])]),i("div",{staticClass:"above-game"},[i("a",{staticClass:"restart-button"},[t._v("新游戏")])]),i("div",{staticClass:"game-event-box"},[i("div",{staticClass:"game-container"},[i("div",{staticClass:"game-message"},[i("p"),i("div",{staticClass:"lower"},[i("a",{staticClass:"keep-playing-button"},[t._v("继续")]),i("a",{staticClass:"retry-button"},[t._v("再试一次")])])]),i("div",{staticClass:"grid-container"},[i("div",{staticClass:"grid-row"},[i("div",{staticClass:"grid-cell"}),i("div",{staticClass:"grid-cell"}),i("div",{staticClass:"grid-cell"}),i("div",{staticClass:"grid-cell"})]),i("div",{staticClass:"grid-row"},[i("div",{staticClass:"grid-cell"}),i("div",{staticClass:"grid-cell"}),i("div",{staticClass:"grid-cell"}),i("div",{staticClass:"grid-cell"})]),i("div",{staticClass:"grid-row"},[i("div",{staticClass:"grid-cell"}),i("div",{staticClass:"grid-cell"}),i("div",{staticClass:"grid-cell"}),i("div",{staticClass:"grid-cell"})]),i("div",{staticClass:"grid-row"},[i("div",{staticClass:"grid-cell"}),i("div",{staticClass:"grid-cell"}),i("div",{staticClass:"grid-cell"}),i("div",{staticClass:"grid-cell"})])]),i("div",{staticClass:"tile-container"})])])])}];i("ac6a");function n(t,e){this.x=t.x,this.y=t.y,this.value=e||2,this.previousPosition=null,this.mergedFrom=null}n.prototype.savePosition=function(){this.previousPosition={x:this.x,y:this.y}},n.prototype.updatePosition=function(t){this.x=t.x,this.y=t.y},n.prototype.serialize=function(){return{position:{x:this.x,y:this.y},value:this.value}};var a=n;function r(t,e){this.size=t,this.cells=e?this.fromState(e):this.empty()}r.prototype.empty=function(){for(var t=[],e=0;e<this.size;e++)for(var i=t[e]=[],s=0;s<this.size;s++)i.push(null);return t},r.prototype.fromState=function(t){for(var e=[],i=0;i<this.size;i++)for(var s=e[i]=[],o=0;o<this.size;o++){var n=t[i][o];s.push(n?new a(n.position,n.value):null)}return e},r.prototype.randomAvailableCell=function(){var t=this.availableCells();if(t.length)return t[Math.floor(Math.random()*t.length)]},r.prototype.availableCells=function(){var t=[];return this.eachCell((function(e,i,s){s||t.push({x:e,y:i})})),t},r.prototype.eachCell=function(t){for(var e=0;e<this.size;e++)for(var i=0;i<this.size;i++)t(e,i,this.cells[e][i])},r.prototype.cellsAvailable=function(){return!!this.availableCells().length},r.prototype.cellAvailable=function(t){return!this.cellOccupied(t)},r.prototype.cellOccupied=function(t){return!!this.cellContent(t)},r.prototype.cellContent=function(t){return this.withinBounds(t)?this.cells[t.x][t.y]:null},r.prototype.insertTile=function(t){this.cells[t.x][t.y]=t},r.prototype.removeTile=function(t){this.cells[t.x][t.y]=null},r.prototype.withinBounds=function(t){return t.x>=0&&t.x<this.size&&t.y>=0&&t.y<this.size},r.prototype.serialize=function(){for(var t=[],e=0;e<this.size;e++)for(var i=t[e]=[],s=0;s<this.size;s++)i.push(this.cells[e][s]?this.cells[e][s].serialize():null);return{size:this.size,cells:t}};var l=r;function c(t,e,i,s){this.size=t,this.inputManager=new e,this.storageManager=new s,this.actuator=new i,this.startTiles=2,this.inputManager.on("move",this.move.bind(this)),this.inputManager.on("restart",this.restart.bind(this)),this.inputManager.on("keepPlaying",this.keepPlaying.bind(this)),this.hooks={start:function(){console.log("hooks start")},end:function(t){console.log("hooks end",t)}},this.setup()}c.prototype.restart=function(){this.hooks.start(),this.storageManager.clearGameState(),this.actuator.continueGame(),this.setup()},c.prototype.keepPlaying=function(){this.keepPlaying=!0,this.actuator.continueGame()},c.prototype.isGameTerminated=function(){return this.over||this.won&&!this.keepPlaying},c.prototype.setup=function(){var t=this.storageManager.getGameState();t?(this.grid=new l(t.grid.size,t.grid.cells),this.score=t.score,this.over=t.over,this.won=t.won,this.keepPlaying=t.keepPlaying):(this.grid=new l(this.size),this.score=0,this.over=!1,this.won=!1,this.keepPlaying=!1,this.addStartTiles()),this.actuate()},c.prototype.addStartTiles=function(){for(var t=0;t<this.startTiles;t++)this.addRandomTile()},c.prototype.addRandomTile=function(){if(this.grid.cellsAvailable()){var t=Math.random()<.9?2:4,e=new a(this.grid.randomAvailableCell(),t);this.grid.insertTile(e)}},c.prototype.actuate=function(){this.storageManager.getBestScore()<this.score&&this.storageManager.setBestScore(this.score),this.over?this.storageManager.clearGameState():this.storageManager.setGameState(this.serialize()),this.actuator.actuate(this.grid,{score:this.score,over:this.over,won:this.won,bestScore:this.storageManager.getBestScore(),terminated:this.isGameTerminated()})},c.prototype.serialize=function(){return{grid:this.grid.serialize(),score:this.score,over:this.over,won:this.won,keepPlaying:this.keepPlaying}},c.prototype.prepareTiles=function(){this.grid.eachCell((function(t,e,i){i&&(i.mergedFrom=null,i.savePosition())}))},c.prototype.moveTile=function(t,e){this.grid.cells[t.x][t.y]=null,this.grid.cells[e.x][e.y]=t,t.updatePosition(e)},c.prototype.move=function(t){var e=this;if(!this.isGameTerminated()){var i,s,o=this.getVector(t),n=this.buildTraversals(o),r=!1;this.prepareTiles(),n.x.forEach((function(t){n.y.forEach((function(n){if(i={x:t,y:n},s=e.grid.cellContent(i),s){var l=e.findFarthestPosition(i,o),c=e.grid.cellContent(l.next);if(c&&c.value===s.value&&!c.mergedFrom){var h=new a(l.next,2*s.value);h.mergedFrom=[s,c],e.grid.insertTile(h),e.grid.removeTile(s),s.updatePosition(l.next),e.score+=h.value,2048===h.value&&(e.won=!0)}else e.moveTile(s,l.farthest);e.positionsEqual(i,s)||(r=!0)}}))})),r&&(this.addRandomTile(),this.movesAvailable()||(this.over=!0,this.hooks.end({score:e.score})),this.actuate())}},c.prototype.getVector=function(t){var e={0:{x:0,y:-1},1:{x:1,y:0},2:{x:0,y:1},3:{x:-1,y:0}};return e[t]},c.prototype.buildTraversals=function(t){for(var e={x:[],y:[]},i=0;i<this.size;i++)e.x.push(i),e.y.push(i);return 1===t.x&&(e.x=e.x.reverse()),1===t.y&&(e.y=e.y.reverse()),e},c.prototype.findFarthestPosition=function(t,e){var i;do{i=t,t={x:i.x+e.x,y:i.y+e.y}}while(this.grid.withinBounds(t)&&this.grid.cellAvailable(t));return{farthest:i,next:t}},c.prototype.movesAvailable=function(){return this.grid.cellsAvailable()||this.tileMatchesAvailable()},c.prototype.tileMatchesAvailable=function(){for(var t,e=this,i=0;i<this.size;i++)for(var s=0;s<this.size;s++)if(t=this.grid.cellContent({x:i,y:s}),t)for(var o=0;o<4;o++){var n=e.getVector(o),a={x:i+n.x,y:s+n.y},r=e.grid.cellContent(a);if(r&&r.value===t.value)return!0}return!1},c.prototype.positionsEqual=function(t,e){return t.x===e.x&&t.y===e.y};var h=c;function u(){this.events={},window.navigator.msPointerEnabled?(this.eventTouchstart="MSPointerDown",this.eventTouchmove="MSPointerMove",this.eventTouchend="MSPointerUp"):(this.eventTouchstart="touchstart",this.eventTouchmove="touchmove",this.eventTouchend="touchend"),this.listen()}u.prototype.on=function(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)},u.prototype.emit=function(t,e){var i=this.events[t];i&&i.forEach((function(t){t(e)}))},u.prototype.listen=function(){var t,e,i=this,s={38:0,39:1,40:2,37:3,75:0,76:1,74:2,72:3,87:0,68:1,83:2,65:3};document.addEventListener("keydown",(function(t){var e=t.altKey||t.ctrlKey||t.metaKey||t.shiftKey,o=s[t.which];e||void 0!==o&&(t.preventDefault(),i.emit("move",o)),e||82!==t.which||i.restart.call(i,t)})),this.bindButtonPress(".retry-button",this.restart),this.bindButtonPress(".restart-button",this.restart),this.bindButtonPress(".keep-playing-button",this.keepPlaying);var o=document.getElementsByClassName("game-event-box")[0];o.addEventListener(this.eventTouchstart,(function(i){!window.navigator.msPointerEnabled&&i.touches.length>1||i.targetTouches.length>1||(window.navigator.msPointerEnabled?(t=i.pageX,e=i.pageY):(t=i.touches[0].clientX,e=i.touches[0].clientY),i.preventDefault())})),o.addEventListener(this.eventTouchmove,(function(t){t.preventDefault()})),o.addEventListener(this.eventTouchend,(function(s){if(!(!window.navigator.msPointerEnabled&&s.touches.length>0||s.targetTouches.length>0)){var o,n;window.navigator.msPointerEnabled?(o=s.pageX,n=s.pageY):(o=s.changedTouches[0].clientX,n=s.changedTouches[0].clientY);var a=o-t,r=Math.abs(a),l=n-e,c=Math.abs(l);Math.max(r,c)>10&&i.emit("move",r>c?a>0?1:3:l>0?2:0)}}))},u.prototype.restart=function(t){t.preventDefault(),this.emit("restart")},u.prototype.keepPlaying=function(t){t.preventDefault(),this.emit("keepPlaying")},u.prototype.bindButtonPress=function(t,e){var i=document.querySelector(t);i.addEventListener("click",e.bind(this)),i.addEventListener(this.eventTouchend,e.bind(this))};var d=u;function p(){this.tileContainer=document.querySelector(".tile-container"),this.scoreContainer=document.querySelector(".score-container"),this.bestContainer=document.querySelector(".best-container"),this.messageContainer=document.querySelector(".game-message"),this.score=0}p.prototype.actuate=function(t,e){var i=this;window.requestAnimationFrame((function(){i.clearContainer(i.tileContainer),t.cells.forEach((function(t){t.forEach((function(t){t&&i.addTile(t)}))})),i.updateScore(e.score),i.updateBestScore(e.bestScore),e.terminated&&(e.over?i.message(!1):e.won&&i.message(!0))}))},p.prototype.continueGame=function(){this.clearMessage()},p.prototype.clearContainer=function(t){while(t.firstChild)t.removeChild(t.firstChild)},p.prototype.addTile=function(t){var e=this,i=document.createElement("div"),s=document.createElement("div"),o=t.previousPosition||{x:t.x,y:t.y},n=this.positionClass(o),a=["tile","tile-"+t.value,n];t.value>2048&&a.push("tile-super"),this.applyClasses(i,a),s.classList.add("tile-inner"),s.textContent=t.value,t.previousPosition?window.requestAnimationFrame((function(){a[2]=e.positionClass({x:t.x,y:t.y}),e.applyClasses(i,a)})):t.mergedFrom?(a.push("tile-merged"),this.applyClasses(i,a),t.mergedFrom.forEach((function(t){e.addTile(t)}))):(a.push("tile-new"),this.applyClasses(i,a)),i.appendChild(s),this.tileContainer.appendChild(i)},p.prototype.applyClasses=function(t,e){t.setAttribute("class",e.join(" "))},p.prototype.normalizePosition=function(t){return{x:t.x+1,y:t.y+1}},p.prototype.positionClass=function(t){return t=this.normalizePosition(t),"tile-position-"+t.x+"-"+t.y},p.prototype.updateScore=function(t){this.clearContainer(this.scoreContainer);var e=t-this.score;if(this.score=t,this.scoreContainer.textContent=this.score,e>0){var i=document.createElement("div");i.classList.add("score-addition"),i.textContent="+"+e,this.scoreContainer.appendChild(i)}},p.prototype.updateBestScore=function(t){this.bestContainer.textContent=t},p.prototype.message=function(t){var e=t?"game-won":"game-over",i=t?"你赢了!":"游戏结束!";this.messageContainer.classList.add(e),this.messageContainer.getElementsByTagName("p")[0].textContent=i},p.prototype.clearMessage=function(){this.messageContainer.classList.remove("game-won"),this.messageContainer.classList.remove("game-over")};var v=p;function g(){this.bestScoreKey="bestScore",this.gameStateKey="gameState";var t=this.localStorageSupported();this.storage=t?window.localStorage:window.fakeStorage}window.fakeStorage={_data:{},setItem:function(t,e){return this._data[t]=String(e)},getItem:function(t){return this._data.hasOwnProperty(t)?this._data[t]:void 0},removeItem:function(t){return delete this._data[t]},clear:function(){return this._data={}}},g.prototype.localStorageSupported=function(){var t="test";try{var e=window.localStorage;return e.setItem(t,"1"),e.removeItem(t),!0}catch(i){return!1}},g.prototype.getBestScore=function(){return this.storage.getItem(this.bestScoreKey)||0},g.prototype.setBestScore=function(t){this.storage.setItem(this.bestScoreKey,t)},g.prototype.getGameState=function(){var t=this.storage.getItem(this.gameStateKey);return t?JSON.parse(t):null},g.prototype.setGameState=function(t){this.storage.setItem(this.gameStateKey,JSON.stringify(t))},g.prototype.clearGameState=function(){this.storage.removeItem(this.gameStateKey)};var y=g,m=i("ba34"),f={name:"home",data:function(){return{}},computed:{},components:{},methods:{},mounted:function(){var t=new h(4,d,v,y),e=this.$route.query||{};m["a"].app&&(m["b"].onAdCompletion((function(t){console.log(t)})),t.hooks.start=function(){m["b"].gameShowAd(e)})}},C=f,w=(i("c741"),i("2877")),b=Object(w["a"])(C,s,o,!1,null,null,null);e["default"]=b.exports},"7e77":function(t,e,i){},c741:function(t,e,i){"use strict";i("7e77")}}]);
//# sourceMappingURL=chunk-5d71c3ec.42ef4355.js.map