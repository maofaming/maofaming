{"version":3,"sources":["webpack:///./src/views/2048/Index.vue?f383","webpack:///./src/views/2048/js/tile.js","webpack:///./src/views/2048/js/grid.js","webpack:///./src/views/2048/js/game_manager.js","webpack:///./src/views/2048/js/keyboard_input_manager.js","webpack:///./src/views/2048/js/html_actuator.js","webpack:///./src/views/2048/js/local_storage_manager.js","webpack:///src/views/2048/Index.vue","webpack:///./src/views/2048/Index.vue?e81c","webpack:///./src/views/2048/Index.vue","webpack:///./src/views/2048/Index.vue?6b63"],"names":["render","_vm","this","_h","$createElement","_self","_c","_m","staticRenderFns","staticClass","_v","Tile","position","value","x","y","previousPosition","mergedFrom","prototype","savePosition","updatePosition","serialize","Grid","size","previousState","cells","fromState","empty","row","push","state","tile","randomAvailableCell","availableCells","length","Math","floor","random","eachCell","callback","cellsAvailable","cellAvailable","cell","cellOccupied","cellContent","withinBounds","insertTile","removeTile","cellState","GameManager","InputManager","Actuator","StorageManager","inputManager","storageManager","actuator","startTiles","on","move","bind","restart","keepPlaying","hooks","start","console","log","end","params","setup","clearGameState","continueGame","isGameTerminated","over","won","getGameState","grid","score","addStartTiles","actuate","i","addRandomTile","getBestScore","setBestScore","setGameState","bestScore","terminated","prepareTiles","moveTile","direction","self","vector","getVector","traversals","buildTraversals","moved","forEach","positions","findFarthestPosition","next","merged","farthest","positionsEqual","movesAvailable","map","0","1","2","3","pos","reverse","previous","tileMatchesAvailable","other","first","second","KeyboardInputManager","events","window","navigator","msPointerEnabled","eventTouchstart","eventTouchmove","eventTouchend","listen","event","emit","data","callbacks","touchStartClientX","touchStartClientY","38","39","40","37","75","76","74","72","87","68","83","65","document","addEventListener","modifiers","altKey","ctrlKey","metaKey","shiftKey","mapped","which","undefined","preventDefault","call","bindButtonPress","gameContainer","getElementsByClassName","touches","targetTouches","pageX","pageY","clientX","clientY","touchEndClientX","touchEndClientY","changedTouches","dx","absDx","abs","dy","absDy","max","selector","fn","button","querySelector","HTMLActuator","tileContainer","scoreContainer","bestContainer","messageContainer","metadata","requestAnimationFrame","clearContainer","column","addTile","updateScore","updateBestScore","message","clearMessage","container","firstChild","removeChild","wrapper","createElement","inner","positionClass","classes","applyClasses","classList","add","textContent","appendChild","element","setAttribute","join","normalizePosition","difference","addition","type","getElementsByTagName","remove","LocalStorageManager","bestScoreKey","gameStateKey","supported","localStorageSupported","storage","localStorage","fakeStorage","_data","setItem","id","val","String","getItem","hasOwnProperty","removeItem","clear","testKey","error","stateJSON","JSON","parse","gameState","stringify","name","computed","components","methods","mounted","sdk","gameInstance","component"],"mappings":"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","file":"js/chunk-5d71c3ec.42ef4355.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"heading\"},[_c('h1',{staticClass:\"title\"},[_vm._v(\"2048\")]),_c('div',{staticClass:\"scores-container\"},[_c('div',{staticClass:\"score-container\"},[_vm._v(\"0\")]),_c('div',{staticClass:\"best-container\"},[_vm._v(\"0\")])])]),_c('div',{staticClass:\"above-game\"},[_c('a',{staticClass:\"restart-button\"},[_vm._v(\"新游戏\")])]),_c('div',{staticClass:\"game-event-box\"},[_c('div',{staticClass:\"game-container\"},[_c('div',{staticClass:\"game-message\"},[_c('p'),_c('div',{staticClass:\"lower\"},[_c('a',{staticClass:\"keep-playing-button\"},[_vm._v(\"继续\")]),_c('a',{staticClass:\"retry-button\"},[_vm._v(\"再试一次\")])])]),_c('div',{staticClass:\"grid-container\"},[_c('div',{staticClass:\"grid-row\"},[_c('div',{staticClass:\"grid-cell\"}),_c('div',{staticClass:\"grid-cell\"}),_c('div',{staticClass:\"grid-cell\"}),_c('div',{staticClass:\"grid-cell\"})]),_c('div',{staticClass:\"grid-row\"},[_c('div',{staticClass:\"grid-cell\"}),_c('div',{staticClass:\"grid-cell\"}),_c('div',{staticClass:\"grid-cell\"}),_c('div',{staticClass:\"grid-cell\"})]),_c('div',{staticClass:\"grid-row\"},[_c('div',{staticClass:\"grid-cell\"}),_c('div',{staticClass:\"grid-cell\"}),_c('div',{staticClass:\"grid-cell\"}),_c('div',{staticClass:\"grid-cell\"})]),_c('div',{staticClass:\"grid-row\"},[_c('div',{staticClass:\"grid-cell\"}),_c('div',{staticClass:\"grid-cell\"}),_c('div',{staticClass:\"grid-cell\"}),_c('div',{staticClass:\"grid-cell\"})])]),_c('div',{staticClass:\"tile-container\"})])])])}]\n\nexport { render, staticRenderFns }","function Tile(position, value) {\n    this.x = position.x;\n    this.y = position.y;\n    this.value = value || 2;\n\n    this.previousPosition = null;\n    this.mergedFrom = null; // Tracks tiles that merged together\n}\n\nTile.prototype.savePosition = function () {\n    this.previousPosition = {x: this.x, y: this.y};\n};\n\nTile.prototype.updatePosition = function (position) {\n    this.x = position.x;\n    this.y = position.y;\n};\n\nTile.prototype.serialize = function () {\n    return {\n        position: {\n            x: this.x,\n            y: this.y\n        },\n        value: this.value\n    };\n};\n\nexport default Tile\n","import Tile from './tile'\n\nfunction Grid(size, previousState) {\n    this.size = size;\n    this.cells = previousState ? this.fromState(previousState) : this.empty();\n}\n\n// Build a grid of the specified size\nGrid.prototype.empty = function () {\n    var cells = [];\n\n    for (var x = 0; x < this.size; x++) {\n        var row = cells[x] = [];\n\n        for (var y = 0; y < this.size; y++) {\n            row.push(null);\n        }\n    }\n\n    return cells;\n};\n\nGrid.prototype.fromState = function (state) {\n    var cells = [];\n\n    for (var x = 0; x < this.size; x++) {\n        var row = cells[x] = [];\n\n        for (var y = 0; y < this.size; y++) {\n            var tile = state[x][y];\n            row.push(tile ? new Tile(tile.position, tile.value) : null);\n        }\n    }\n\n    return cells;\n};\n\n// Find the first available random position\nGrid.prototype.randomAvailableCell = function () {\n    var cells = this.availableCells();\n\n    if (cells.length) {\n        return cells[Math.floor(Math.random() * cells.length)];\n    }\n};\n\nGrid.prototype.availableCells = function () {\n    var cells = [];\n\n    this.eachCell(function (x, y, tile) {\n        if (!tile) {\n            cells.push({x: x, y: y});\n        }\n    });\n\n    return cells;\n};\n\n// Call callback for every cell\nGrid.prototype.eachCell = function (callback) {\n    for (var x = 0; x < this.size; x++) {\n        for (var y = 0; y < this.size; y++) {\n            callback(x, y, this.cells[x][y]);\n        }\n    }\n};\n\n// Check if there are any cells available\nGrid.prototype.cellsAvailable = function () {\n    return !!this.availableCells().length;\n};\n\n// Check if the specified cell is taken\nGrid.prototype.cellAvailable = function (cell) {\n    return !this.cellOccupied(cell);\n};\n\nGrid.prototype.cellOccupied = function (cell) {\n    return !!this.cellContent(cell);\n};\n\nGrid.prototype.cellContent = function (cell) {\n    if (this.withinBounds(cell)) {\n        return this.cells[cell.x][cell.y];\n    } else {\n        return null;\n    }\n};\n\n// Inserts a tile at its position\nGrid.prototype.insertTile = function (tile) {\n    this.cells[tile.x][tile.y] = tile;\n};\n\nGrid.prototype.removeTile = function (tile) {\n    this.cells[tile.x][tile.y] = null;\n};\n\nGrid.prototype.withinBounds = function (position) {\n    return position.x >= 0 && position.x < this.size &&\n        position.y >= 0 && position.y < this.size;\n};\n\nGrid.prototype.serialize = function () {\n    var cellState = [];\n\n    for (var x = 0; x < this.size; x++) {\n        var row = cellState[x] = [];\n\n        for (var y = 0; y < this.size; y++) {\n            row.push(this.cells[x][y] ? this.cells[x][y].serialize() : null);\n        }\n    }\n\n    return {\n        size: this.size,\n        cells: cellState\n    };\n};\n\nexport default Grid\n","import Tile from './tile'\nimport Grid from './grid'\n\nfunction GameManager(size, InputManager, Actuator, StorageManager) {\n    this.size = size; // Size of the grid\n    this.inputManager = new InputManager;\n    this.storageManager = new StorageManager;\n    this.actuator = new Actuator;\n\n    this.startTiles = 2;\n\n    this.inputManager.on(\"move\", this.move.bind(this));\n    this.inputManager.on(\"restart\", this.restart.bind(this));\n    this.inputManager.on(\"keepPlaying\", this.keepPlaying.bind(this));\n\n    this.hooks = {\n        start: function () {\n            console.log('hooks start')\n        },\n        end: function (params) {\n            console.log('hooks end', params)\n        }\n    }\n\n    this.setup();\n}\n\n// Restart the game\nGameManager.prototype.restart = function () {\n    this.hooks.start()\n    this.storageManager.clearGameState();\n    this.actuator.continueGame(); // Clear the game won/lost message\n    this.setup();\n};\n\n// Keep playing after winning (allows going over 2048)\nGameManager.prototype.keepPlaying = function () {\n    this.keepPlaying = true;\n    this.actuator.continueGame(); // Clear the game won/lost message\n};\n\n// Return true if the game is lost, or has won and the user hasn't kept playing\nGameManager.prototype.isGameTerminated = function () {\n    return this.over || (this.won && !this.keepPlaying);\n};\n\n// Set up the game\nGameManager.prototype.setup = function () {\n    var previousState = this.storageManager.getGameState();\n\n    // Reload the game from a previous game if present\n    if (previousState) {\n        this.grid = new Grid(previousState.grid.size,\n            previousState.grid.cells); // Reload grid\n        this.score = previousState.score;\n        this.over = previousState.over;\n        this.won = previousState.won;\n        this.keepPlaying = previousState.keepPlaying;\n    } else {\n        this.grid = new Grid(this.size);\n        this.score = 0;\n        this.over = false;\n        this.won = false;\n        this.keepPlaying = false;\n\n        // Add the initial tiles\n        this.addStartTiles();\n    }\n\n    // Update the actuator\n    this.actuate();\n};\n\n// Set up the initial tiles to start the game with\nGameManager.prototype.addStartTiles = function () {\n    for (var i = 0; i < this.startTiles; i++) {\n        this.addRandomTile();\n    }\n};\n\n// Adds a tile in a random position\nGameManager.prototype.addRandomTile = function () {\n    if (this.grid.cellsAvailable()) {\n        var value = Math.random() < 0.9 ? 2 : 4;\n        var tile = new Tile(this.grid.randomAvailableCell(), value);\n\n        this.grid.insertTile(tile);\n    }\n};\n\n// Sends the updated grid to the actuator\nGameManager.prototype.actuate = function () {\n    if (this.storageManager.getBestScore() < this.score) {\n        this.storageManager.setBestScore(this.score);\n    }\n\n    // Clear the state when the game is over (game over only, not win)\n    if (this.over) {\n        this.storageManager.clearGameState();\n    } else {\n        this.storageManager.setGameState(this.serialize());\n    }\n\n    this.actuator.actuate(this.grid, {\n        score: this.score,\n        over: this.over,\n        won: this.won,\n        bestScore: this.storageManager.getBestScore(),\n        terminated: this.isGameTerminated()\n    });\n\n};\n\n// Represent the current game as an object\nGameManager.prototype.serialize = function () {\n    return {\n        grid: this.grid.serialize(),\n        score: this.score,\n        over: this.over,\n        won: this.won,\n        keepPlaying: this.keepPlaying\n    };\n};\n\n// Save all tile positions and remove merger info\nGameManager.prototype.prepareTiles = function () {\n    this.grid.eachCell(function (x, y, tile) {\n        if (tile) {\n            tile.mergedFrom = null;\n            tile.savePosition();\n        }\n    });\n};\n\n// Move a tile and its representation\nGameManager.prototype.moveTile = function (tile, cell) {\n    this.grid.cells[tile.x][tile.y] = null;\n    this.grid.cells[cell.x][cell.y] = tile;\n    tile.updatePosition(cell);\n};\n\n// Move tiles on the grid in the specified direction\nGameManager.prototype.move = function (direction) {\n    // 0: up, 1: right, 2: down, 3: left\n    var self = this;\n\n    if (this.isGameTerminated()) return; // Don't do anything if the game's over\n\n    var cell, tile;\n\n    var vector = this.getVector(direction);\n    var traversals = this.buildTraversals(vector);\n    var moved = false;\n\n    // Save the current tile positions and remove merger information\n    this.prepareTiles();\n\n    // Traverse the grid in the right direction and move tiles\n    traversals.x.forEach(function (x) {\n        traversals.y.forEach(function (y) {\n            cell = {x: x, y: y};\n            tile = self.grid.cellContent(cell);\n\n            if (tile) {\n                var positions = self.findFarthestPosition(cell, vector);\n                var next = self.grid.cellContent(positions.next);\n\n                // Only one merger per row traversal?\n                if (next && next.value === tile.value && !next.mergedFrom) {\n                    var merged = new Tile(positions.next, tile.value * 2);\n                    merged.mergedFrom = [tile, next];\n\n                    self.grid.insertTile(merged);\n                    self.grid.removeTile(tile);\n\n                    // Converge the two tiles' positions\n                    tile.updatePosition(positions.next);\n\n                    // Update the score\n                    self.score += merged.value;\n\n                    // The mighty 2048 tile\n                    if (merged.value === 2048) self.won = true;\n                } else {\n                    self.moveTile(tile, positions.farthest);\n                }\n\n                if (!self.positionsEqual(cell, tile)) {\n                    moved = true; // The tile moved from its original cell!\n                }\n            }\n        });\n    });\n\n    if (moved) {\n        this.addRandomTile();\n\n        if (!this.movesAvailable()) {\n            this.over = true; // Game over!\n            this.hooks.end({\n                score: self.score\n            })\n        }\n\n        this.actuate();\n    }\n};\n\n// Get the vector representing the chosen direction\nGameManager.prototype.getVector = function (direction) {\n    // Vectors representing tile movement\n    var map = {\n        0: {x: 0, y: -1}, // Up\n        1: {x: 1, y: 0},  // Right\n        2: {x: 0, y: 1},  // Down\n        3: {x: -1, y: 0}   // Left\n    };\n\n    return map[direction];\n};\n\n// Build a list of positions to traverse in the right order\nGameManager.prototype.buildTraversals = function (vector) {\n    var traversals = {x: [], y: []};\n\n    for (var pos = 0; pos < this.size; pos++) {\n        traversals.x.push(pos);\n        traversals.y.push(pos);\n    }\n\n    // Always traverse from the farthest cell in the chosen direction\n    if (vector.x === 1) traversals.x = traversals.x.reverse();\n    if (vector.y === 1) traversals.y = traversals.y.reverse();\n\n    return traversals;\n};\n\nGameManager.prototype.findFarthestPosition = function (cell, vector) {\n    var previous;\n\n    // Progress towards the vector direction until an obstacle is found\n    do {\n        previous = cell;\n        cell = {x: previous.x + vector.x, y: previous.y + vector.y};\n    } while (this.grid.withinBounds(cell) &&\n    this.grid.cellAvailable(cell));\n\n    return {\n        farthest: previous,\n        next: cell // Used to check if a merge is required\n    };\n};\n\nGameManager.prototype.movesAvailable = function () {\n    return this.grid.cellsAvailable() || this.tileMatchesAvailable();\n};\n\n// Check for available matches between tiles (more expensive check)\nGameManager.prototype.tileMatchesAvailable = function () {\n    var self = this;\n\n    var tile;\n\n    for (var x = 0; x < this.size; x++) {\n        for (var y = 0; y < this.size; y++) {\n            tile = this.grid.cellContent({x: x, y: y});\n\n            if (tile) {\n                for (var direction = 0; direction < 4; direction++) {\n                    var vector = self.getVector(direction);\n                    var cell = {x: x + vector.x, y: y + vector.y};\n\n                    var other = self.grid.cellContent(cell);\n\n                    if (other && other.value === tile.value) {\n                        return true; // These two tiles can be merged\n                    }\n                }\n            }\n        }\n    }\n\n    return false;\n};\n\nGameManager.prototype.positionsEqual = function (first, second) {\n    return first.x === second.x && first.y === second.y;\n};\n\nexport default GameManager\n","function KeyboardInputManager() {\n    this.events = {};\n\n    if (window.navigator.msPointerEnabled) {\n        //Internet Explorer 10 style\n        this.eventTouchstart = \"MSPointerDown\";\n        this.eventTouchmove = \"MSPointerMove\";\n        this.eventTouchend = \"MSPointerUp\";\n    } else {\n        this.eventTouchstart = \"touchstart\";\n        this.eventTouchmove = \"touchmove\";\n        this.eventTouchend = \"touchend\";\n    }\n\n    this.listen();\n}\n\nKeyboardInputManager.prototype.on = function (event, callback) {\n    if (!this.events[event]) {\n        this.events[event] = [];\n    }\n    this.events[event].push(callback);\n};\n\nKeyboardInputManager.prototype.emit = function (event, data) {\n    var callbacks = this.events[event];\n    if (callbacks) {\n        callbacks.forEach(function (callback) {\n            callback(data);\n        });\n    }\n};\n\nKeyboardInputManager.prototype.listen = function () {\n    var self = this;\n\n    var map = {\n        38: 0, // Up\n        39: 1, // Right\n        40: 2, // Down\n        37: 3, // Left\n        75: 0, // Vim up\n        76: 1, // Vim right\n        74: 2, // Vim down\n        72: 3, // Vim left\n        87: 0, // W\n        68: 1, // D\n        83: 2, // S\n        65: 3  // A\n    };\n\n    // Respond to direction keys\n    document.addEventListener(\"keydown\", function (event) {\n        var modifiers = event.altKey || event.ctrlKey || event.metaKey ||\n            event.shiftKey;\n        var mapped = map[event.which];\n\n        if (!modifiers) {\n            if (mapped !== undefined) {\n                event.preventDefault();\n                self.emit(\"move\", mapped);\n            }\n        }\n\n        // R key restarts the game\n        if (!modifiers && event.which === 82) {\n            self.restart.call(self, event);\n        }\n    });\n\n    // Respond to button presses\n    this.bindButtonPress(\".retry-button\", this.restart);\n    this.bindButtonPress(\".restart-button\", this.restart);\n    this.bindButtonPress(\".keep-playing-button\", this.keepPlaying);\n\n    // Respond to swipe events\n    var touchStartClientX, touchStartClientY;\n    // var gameContainer = document.getElementsByClassName(\"game-container\")[0];\n    var gameContainer = document.getElementsByClassName(\"game-event-box\")[0];\n\n    gameContainer.addEventListener(this.eventTouchstart, function (event) {\n        if ((!window.navigator.msPointerEnabled && event.touches.length > 1) ||\n            event.targetTouches.length > 1) {\n            return; // Ignore if touching with more than 1 finger\n        }\n\n        if (window.navigator.msPointerEnabled) {\n            touchStartClientX = event.pageX;\n            touchStartClientY = event.pageY;\n        } else {\n            touchStartClientX = event.touches[0].clientX;\n            touchStartClientY = event.touches[0].clientY;\n        }\n\n        event.preventDefault();\n    });\n\n    gameContainer.addEventListener(this.eventTouchmove, function (event) {\n        event.preventDefault();\n    });\n\n    gameContainer.addEventListener(this.eventTouchend, function (event) {\n        if ((!window.navigator.msPointerEnabled && event.touches.length > 0) ||\n            event.targetTouches.length > 0) {\n            return; // Ignore if still touching with one or more fingers\n        }\n\n        var touchEndClientX, touchEndClientY;\n\n        if (window.navigator.msPointerEnabled) {\n            touchEndClientX = event.pageX;\n            touchEndClientY = event.pageY;\n        } else {\n            touchEndClientX = event.changedTouches[0].clientX;\n            touchEndClientY = event.changedTouches[0].clientY;\n        }\n\n        var dx = touchEndClientX - touchStartClientX;\n        var absDx = Math.abs(dx);\n\n        var dy = touchEndClientY - touchStartClientY;\n        var absDy = Math.abs(dy);\n\n        if (Math.max(absDx, absDy) > 10) {\n            // (right : left) : (down : up)\n            self.emit(\"move\", absDx > absDy ? (dx > 0 ? 1 : 3) : (dy > 0 ? 2 : 0));\n        }\n    });\n};\n\nKeyboardInputManager.prototype.restart = function (event) {\n    event.preventDefault();\n    this.emit(\"restart\");\n};\n\nKeyboardInputManager.prototype.keepPlaying = function (event) {\n    event.preventDefault();\n    this.emit(\"keepPlaying\");\n};\n\nKeyboardInputManager.prototype.bindButtonPress = function (selector, fn) {\n    var button = document.querySelector(selector);\n    button.addEventListener(\"click\", fn.bind(this));\n    button.addEventListener(this.eventTouchend, fn.bind(this));\n};\n\nexport default KeyboardInputManager\n","function HTMLActuator() {\n    this.tileContainer = document.querySelector(\".tile-container\");\n    this.scoreContainer = document.querySelector(\".score-container\");\n    this.bestContainer = document.querySelector(\".best-container\");\n    this.messageContainer = document.querySelector(\".game-message\");\n\n    this.score = 0;\n}\n\nHTMLActuator.prototype.actuate = function (grid, metadata) {\n    var self = this;\n\n    window.requestAnimationFrame(function () {\n        self.clearContainer(self.tileContainer);\n\n        grid.cells.forEach(function (column) {\n            column.forEach(function (cell) {\n                if (cell) {\n                    self.addTile(cell);\n                }\n            });\n        });\n\n        self.updateScore(metadata.score);\n        self.updateBestScore(metadata.bestScore);\n\n        if (metadata.terminated) {\n            if (metadata.over) {\n                self.message(false); // You lose\n            } else if (metadata.won) {\n                self.message(true); // You win!\n            }\n        }\n\n    });\n};\n\n// Continues the game (both restart and keep playing)\nHTMLActuator.prototype.continueGame = function () {\n    this.clearMessage();\n};\n\nHTMLActuator.prototype.clearContainer = function (container) {\n    while (container.firstChild) {\n        container.removeChild(container.firstChild);\n    }\n};\n\nHTMLActuator.prototype.addTile = function (tile) {\n    var self = this;\n\n    var wrapper = document.createElement(\"div\");\n    var inner = document.createElement(\"div\");\n    var position = tile.previousPosition || {x: tile.x, y: tile.y};\n    var positionClass = this.positionClass(position);\n\n    // We can't use classlist because it somehow glitches when replacing classes\n    var classes = [\"tile\", \"tile-\" + tile.value, positionClass];\n\n    if (tile.value > 2048) classes.push(\"tile-super\");\n\n    this.applyClasses(wrapper, classes);\n\n    inner.classList.add(\"tile-inner\");\n    inner.textContent = tile.value;\n\n    if (tile.previousPosition) {\n        // Make sure that the tile gets rendered in the previous position first\n        window.requestAnimationFrame(function () {\n            classes[2] = self.positionClass({x: tile.x, y: tile.y});\n            self.applyClasses(wrapper, classes); // Update the position\n        });\n    } else if (tile.mergedFrom) {\n        classes.push(\"tile-merged\");\n        this.applyClasses(wrapper, classes);\n\n        // Render the tiles that merged\n        tile.mergedFrom.forEach(function (merged) {\n            self.addTile(merged);\n        });\n    } else {\n        classes.push(\"tile-new\");\n        this.applyClasses(wrapper, classes);\n    }\n\n    // Add the inner part of the tile to the wrapper\n    wrapper.appendChild(inner);\n\n    // Put the tile on the board\n    this.tileContainer.appendChild(wrapper);\n};\n\nHTMLActuator.prototype.applyClasses = function (element, classes) {\n    element.setAttribute(\"class\", classes.join(\" \"));\n};\n\nHTMLActuator.prototype.normalizePosition = function (position) {\n    return {x: position.x + 1, y: position.y + 1};\n};\n\nHTMLActuator.prototype.positionClass = function (position) {\n    position = this.normalizePosition(position);\n    return \"tile-position-\" + position.x + \"-\" + position.y;\n};\n\nHTMLActuator.prototype.updateScore = function (score) {\n    this.clearContainer(this.scoreContainer);\n\n    var difference = score - this.score;\n    this.score = score;\n\n    this.scoreContainer.textContent = this.score;\n\n    if (difference > 0) {\n        var addition = document.createElement(\"div\");\n        addition.classList.add(\"score-addition\");\n        addition.textContent = \"+\" + difference;\n\n        this.scoreContainer.appendChild(addition);\n    }\n};\n\nHTMLActuator.prototype.updateBestScore = function (bestScore) {\n    this.bestContainer.textContent = bestScore;\n};\n\nHTMLActuator.prototype.message = function (won) {\n    var type = won ? \"game-won\" : \"game-over\";\n    var message = won ? \"你赢了!\" : \"游戏结束!\";\n\n    this.messageContainer.classList.add(type);\n    this.messageContainer.getElementsByTagName(\"p\")[0].textContent = message;\n};\n\nHTMLActuator.prototype.clearMessage = function () {\n    // IE only takes one value to remove at a time.\n    this.messageContainer.classList.remove(\"game-won\");\n    this.messageContainer.classList.remove(\"game-over\");\n};\n\n\nexport default HTMLActuator\n","window.fakeStorage = {\n    _data: {},\n\n    setItem: function (id, val) {\n        return this._data[id] = String(val);\n    },\n\n    getItem: function (id) {\n        return this._data.hasOwnProperty(id) ? this._data[id] : undefined;\n    },\n\n    removeItem: function (id) {\n        return delete this._data[id];\n    },\n\n    clear: function () {\n        return this._data = {};\n    }\n};\n\nfunction LocalStorageManager() {\n    this.bestScoreKey = \"bestScore\";\n    this.gameStateKey = \"gameState\";\n\n    var supported = this.localStorageSupported();\n    this.storage = supported ? window.localStorage : window.fakeStorage;\n}\n\nLocalStorageManager.prototype.localStorageSupported = function () {\n    var testKey = \"test\";\n\n    try {\n        var storage = window.localStorage;\n        storage.setItem(testKey, \"1\");\n        storage.removeItem(testKey);\n        return true;\n    } catch (error) {\n        return false;\n    }\n};\n\n// Best score getters/setters\nLocalStorageManager.prototype.getBestScore = function () {\n    return this.storage.getItem(this.bestScoreKey) || 0;\n};\n\nLocalStorageManager.prototype.setBestScore = function (score) {\n    this.storage.setItem(this.bestScoreKey, score);\n};\n\n// Game state getters/setters and clearing\nLocalStorageManager.prototype.getGameState = function () {\n    var stateJSON = this.storage.getItem(this.gameStateKey);\n    return stateJSON ? JSON.parse(stateJSON) : null;\n};\n\nLocalStorageManager.prototype.setGameState = function (gameState) {\n    this.storage.setItem(this.gameStateKey, JSON.stringify(gameState));\n};\n\nLocalStorageManager.prototype.clearGameState = function () {\n    this.storage.removeItem(this.gameStateKey);\n};\n\nexport default LocalStorageManager\n","<template>\n    <div class=\"container\">\n        <div class=\"heading\">\n            <h1 class=\"title\">2048</h1>\n            <div class=\"scores-container\">\n                <div class=\"score-container\">0</div>\n                <div class=\"best-container\">0</div>\n            </div>\n        </div>\n\n        <div class=\"above-game\">\n            <a class=\"restart-button\">新游戏</a>\n        </div>\n\n        <div class=\"game-event-box\">\n            <div class=\"game-container\">\n                <div class=\"game-message\">\n                    <p></p>\n                    <div class=\"lower\">\n                        <a class=\"keep-playing-button\">继续</a>\n                        <a class=\"retry-button\">再试一次</a>\n                    </div>\n                </div>\n\n                <div class=\"grid-container\">\n                    <div class=\"grid-row\">\n                        <div class=\"grid-cell\"></div>\n                        <div class=\"grid-cell\"></div>\n                        <div class=\"grid-cell\"></div>\n                        <div class=\"grid-cell\"></div>\n                    </div>\n                    <div class=\"grid-row\">\n                        <div class=\"grid-cell\"></div>\n                        <div class=\"grid-cell\"></div>\n                        <div class=\"grid-cell\"></div>\n                        <div class=\"grid-cell\"></div>\n                    </div>\n                    <div class=\"grid-row\">\n                        <div class=\"grid-cell\"></div>\n                        <div class=\"grid-cell\"></div>\n                        <div class=\"grid-cell\"></div>\n                        <div class=\"grid-cell\"></div>\n                    </div>\n                    <div class=\"grid-row\">\n                        <div class=\"grid-cell\"></div>\n                        <div class=\"grid-cell\"></div>\n                        <div class=\"grid-cell\"></div>\n                        <div class=\"grid-cell\"></div>\n                    </div>\n                </div>\n\n                <div class=\"tile-container\">\n\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\n    import GameManager from './js/game_manager'\n    import KeyboardInputManager from './js/keyboard_input_manager'\n    import HTMLActuator from './js/html_actuator'\n    import LocalStorageManager from './js/local_storage_manager'\n    import {sdk, browser} from \"../../common/util/bitUtil\";\n\n    export default {\n        name: 'home',\n        /**\n         * 组件的初始数据\n         */\n        data() {\n            return {}\n\n        },\n        computed: {},\n        components: {},\n\n        /**\n         * 组件的方法列表\n         */\n        methods: {},\n        mounted() {\n            const gameInstance = new GameManager(4, KeyboardInputManager, HTMLActuator, LocalStorageManager);\n            let query = this.$route.query || {}\n            if(browser.app){\n                sdk.onAdCompletion(function(params){\n                    console.log(params)\n                })\n\n                gameInstance.hooks.start = function () {\n                    sdk.gameShowAd(query)\n                }\n            }\n        }\n    }\n</script>\n<style lang=\"scss\">\n    /* plugin/components/shopping-center.wxss */\n    @import \"./style/fonts/clear-sans.css\";\n    @import \"./style/main\";\n\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Index.vue?vue&type=template&id=c2de4608&\"\nimport script from \"./Index.vue?vue&type=script&lang=js&\"\nexport * from \"./Index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Index.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Index.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}